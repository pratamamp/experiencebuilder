System.register(["jimu-core","jimu-arcgis","jimu-ui"], function(__WEBPACK_DYNAMIC_EXPORT__, __system_context__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_arcgis__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_ui__ = {};
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_core__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_arcgis__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_ui__, "__esModule", { value: true });
	return {
		setters: [
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_core__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_arcgis__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_ui__[key] = module[key];
				});
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (() => { // webpackBootstrap
/******/ 	var __webpack_modules__ = ({

/***/ "./exb-custom-widgets/widgets/clustering/src/runtime/assets/cluster.svg":
/*!******************************************************************************!*\
  !*** ./exb-custom-widgets/widgets/clustering/src/runtime/assets/cluster.svg ***!
  \******************************************************************************/
/***/ ((module) => {

module.exports = "data:image/svg+xml;base64,PCEtLSBHZW5lcmF0ZWQgYnkgSWNvTW9vbi5pbyAtLT4KPHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgd2lkdGg9IjMyIiBoZWlnaHQ9IjMyIiB2aWV3Qm94PSIwIDAgMzIgMzIiPgo8dGl0bGU+Y2x1c3RlcjwvdGl0bGU+CjxwYXRoIGQ9Ik0xMCA0aC00Yy0xLjEgMC0yIDAuOS0yIDJ2NGMwIDEuMSAwLjkgMiAyIDJoNGMxLjEgMCAyLTAuOSAyLTJ2LTRjMC0xLjEtMC45LTItMi0yeiI+PC9wYXRoPgo8cGF0aCBkPSJNMjIgMTJoNGMxLjEgMCAyLTAuOSAyLTJ2LTRjMC0xLjEtMC45LTItMi0yaC00Yy0xLjEgMC0yIDAuOS0yIDJ2NGMwIDEuMSAwLjkgMiAyIDJ6TTIyIDZoNHY0aC00di00eiI+PC9wYXRoPgo8cGF0aCBkPSJNMTAgMjBoLTRjLTEuMSAwLTIgMC45LTIgMnY0YzAgMS4xIDAuOSAyIDIgMmg0YzEuMSAwIDItMC45IDItMnYtNGMwLTEuMS0wLjktMi0yLTJ6TTEwIDI2aC00di00aDR2NHoiPjwvcGF0aD4KPHBhdGggZD0iTTI2IDIwaC00Yy0xLjEgMC0yIDAuOS0yIDJ2NGMwIDEuMSAwLjkgMiAyIDJoNGMxLjEgMCAyLTAuOSAyLTJ2LTRjMC0xLjEtMC45LTItMi0yeiI+PC9wYXRoPgo8cGF0aCBkPSJNMjggMTZoLTJjLTIuNjcxIDAtNS4xODItMS4wNDAtNy4wNzEtMi45MjlzLTIuOTI5LTQuNC0yLjkyOS03LjA3MXYtMmMwLTIuMi0xLjgtNC00LTRoLThjLTIuMiAwLTQgMS44LTQgNHY4YzAgMi4yIDEuOCA0IDQgNGgyYzIuNjcxIDAgNS4xODIgMS4wNDAgNy4wNzEgMi45MjlzMi45MjkgNC40IDIuOTI5IDcuMDcxdjJjMCAyLjIgMS44IDQgNCA0aDhjMi4yIDAgNC0xLjggNC00di04YzAtMi4yLTEuOC00LTQtNHpNMzAgMjhjMCAwLjUzLTAuMjA5IDEuMDMxLTAuNTg5IDEuNDExcy0wLjg4MSAwLjU4OS0xLjQxMSAwLjU4OWgtOGMtMC41MyAwLTEuMDMxLTAuMjA5LTEuNDExLTAuNTg5cy0wLjU4OS0wLjg4MS0wLjU4OS0xLjQxMXYtMmMwLTYuNjI3LTUuMzczLTEyLTEyLTEyaC0yYy0wLjUzIDAtMS4wMzEtMC4yMDktMS40MTEtMC41ODlzLTAuNTg5LTAuODgxLTAuNTg5LTEuNDExdi04YzAtMC41MyAwLjIwOS0xLjAzMSAwLjU4OS0xLjQxMXMwLjg4MS0wLjU4OSAxLjQxMS0wLjU4OWg4YzAuNTMgMCAxLjAzMSAwLjIwOSAxLjQxMSAwLjU4OXMwLjU4OSAwLjg4MSAwLjU4OSAxLjQxMXYyYzAgNi42MjcgNS4zNzMgMTIgMTIgMTJoMmMwLjUzIDAgMS4wMzEgMC4yMDkgMS40MTEgMC41ODlzMC41ODkgMC44ODEgMC41ODkgMS40MTF2OHoiPjwvcGF0aD4KPC9zdmc+Cg=="

/***/ }),

/***/ "jimu-arcgis":
/*!******************************!*\
  !*** external "jimu-arcgis" ***!
  \******************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_arcgis__;

/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;

/***/ }),

/***/ "jimu-ui":
/*!**************************!*\
  !*** external "jimu-ui" ***!
  \**************************/
/***/ ((module) => {

"use strict";
module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_ui__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/publicPath */
/******/ 	(() => {
/******/ 		__webpack_require__.p = "";
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other entry modules.
(() => {
/*!******************************************!*\
  !*** ./jimu-core/lib/set-public-path.ts ***!
  \******************************************/
/**
 * Webpack will replace __webpack_public_path__ with __webpack_require__.p to set the public path dynamically.
 * The reason why we can't set the publicPath in webpack config is: we change the publicPath when download.
 * */
// eslint-disable-next-line
// @ts-ignore
__webpack_require__.p = window.jimuConfig.baseUrl;

})();

// This entry need to be wrapped in an IIFE because it need to be in strict mode.
(() => {
"use strict";
/*!**********************************************************************!*\
  !*** ./exb-custom-widgets/widgets/clustering/src/runtime/widget.tsx ***!
  \**********************************************************************/
__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   __set_webpack_public_path__: () => (/* binding */ __set_webpack_public_path__),
/* harmony export */   "default": () => (/* binding */ Widget)
/* harmony export */ });
/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ "jimu-core");
/* harmony import */ var jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-arcgis */ "jimu-arcgis");
/* harmony import */ var jimu_ui__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimu-ui */ "jimu-ui");
/** @jsx jsx */
/**
  Licensing

  Copyright 2022 Esri

  Licensed under the Apache License, Version 2.0 (the "License"); You
  may not use this file except in compliance with the License. You may
  obtain a copy of the License at
  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
  implied. See the License for the specific language governing
  permissions and limitations under the License.

  A copy of the license is available in the repository's
  LICENSE file.
*/



class Widget extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.React.PureComponent {
    constructor(props) {
        super(props);
        this.clusterConfig = {
            type: 'cluster',
            clusterRadius: '100px',
            popupTemplate: {
                content: 'This cluster represents <b>{cluster_count}</b> points.',
                fieldInfos: [{
                        fieldName: 'cluster_count',
                        format: {
                            digitSeparator: true,
                            places: 0
                        }
                    }]
            },
            clusterMinSize: '24px',
            clusterMaxSize: '60px',
            labelingInfo: [{
                    deconflictionStrategy: 'none',
                    labelExpressionInfo: {
                        expression: "Text($feature.cluster_count, '#,###')"
                    },
                    labelPlacement: 'center-center'
                }]
        };
        this.onCheckBoxChange = (e) => {
            const valueState = e.target.value;
            this.setState({
                clusterStatus: valueState
            }, () => {
                this.clusterSwitch(this.state.clusterStatus);
            });
        };
        this.clusterSwitch = (e) => {
            if (this.state.clusterStatus) {
                this.state.jimuMapView.jimuLayerViews[this.state.clusterLayer].layer.featureReduction = this.clusterConfig;
            }
            if (!this.state.clusterStatus) {
                this.state.jimuMapView.jimuLayerViews[this.state.clusterLayer].layer.featureReduction = this.state.clusterStatus ? this.clusterConfig : null;
            }
        };
        this.activeViewChangeHandler = (jmv) => {
            if (jmv) {
                const jimuLayerViews = jmv.jimuLayerViews;
                const jimuLayerViewIds = Object.keys(jimuLayerViews)[0];
                const layerViewId = jimuLayerViewIds;
                if (layerViewId === undefined) {
                    jmv = null;
                    return;
                }
                this.setState({
                    jimuMapView: jmv,
                    clusterLayer: jimuLayerViewIds,
                    errorTip: false
                });
            }
            else {
                this.setState({
                    jimuMapView: undefined,
                    clusterLayer: undefined,
                    errorTip: true,
                    clusterStatus: false
                });
            }
        };
        this.state = {
            jimuMapView: undefined,
            clusterLayer: undefined,
            clusterStatus: false,
            errorTip: true
        };
    }
    renderWidgetPlaceholder() {
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_ui__WEBPACK_IMPORTED_MODULE_2__.WidgetPlaceholder, { icon: __webpack_require__(/*! ./assets/cluster.svg */ "./exb-custom-widgets/widgets/clustering/src/runtime/assets/cluster.svg"), widgetId: this.props.id, message: 'Please select a web map with a feature layer to enable point clustering.' });
    }
    render() {
        var _a;
        const mapContent = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.JimuMapViewComponent, { useMapWidgetId: (_a = this.props.useMapWidgetIds) === null || _a === void 0 ? void 0 : _a[0], onActiveViewChange: this.activeViewChangeHandler });
        let clusterContent = null;
        if (this.state.errorTip || !(this.props.useMapWidgetIds && this.props.useMapWidgetIds.length > 0)) {
            clusterContent = this.renderWidgetPlaceholder();
        }
        else {
            clusterContent =
                (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_ui__WEBPACK_IMPORTED_MODULE_2__.Label, { style: { cursor: 'pointer' } },
                    (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)(jimu_ui__WEBPACK_IMPORTED_MODULE_2__.Checkbox, { checked: this.state.clusterStatus, onChange: (e) => {
                            this.onCheckBoxChange({
                                target: {
                                    value: e.target.checked
                                }
                            });
                        } }),
                    " Cluster points ");
        }
        return (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", { style: { height: '100%' }, className: "cluster-map" },
            clusterContent,
            (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.jsx)("div", null, mapContent));
    }
}
function __set_webpack_public_path__(url) { __webpack_require__.p = url; }

})();

/******/ 	return __webpack_exports__;
/******/ })()

			);
		}
	};
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jbHVzdGVyaW5nL2Rpc3QvcnVudGltZS93aWRnZXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEscUNBQXFDOzs7Ozs7Ozs7OztBQ0FyQzs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7Ozs7Ozs7QUNBQTs7Ozs7O1VDQUE7VUFDQTs7VUFFQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7Ozs7V0N0QkE7V0FDQTtXQUNBO1dBQ0E7V0FDQSx5Q0FBeUMsd0NBQXdDO1dBQ2pGO1dBQ0E7V0FDQTs7Ozs7V0NQQTs7Ozs7V0NBQTtXQUNBO1dBQ0E7V0FDQSx1REFBdUQsaUJBQWlCO1dBQ3hFO1dBQ0EsZ0RBQWdELGFBQWE7V0FDN0Q7Ozs7O1dDTkE7Ozs7Ozs7Ozs7QUNBQTs7O0tBR0s7QUFDTCwyQkFBMkI7QUFDM0IsYUFBYTtBQUNiLHFCQUF1QixHQUFHLE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDTm5ELGVBQWU7QUFDZjs7Ozs7Ozs7Ozs7Ozs7Ozs7O0VBa0JFO0FBQ3lEO0FBQ1M7QUFDUjtBQVM3QyxNQUFNLE1BQU8sU0FBUSw0Q0FBSyxDQUFDLGFBQXlDO0lBQ2pGLFlBQWEsS0FBSztRQUNoQixLQUFLLENBQUMsS0FBSyxDQUFDO1FBVWQsa0JBQWEsR0FBRztZQUNkLElBQUksRUFBRSxTQUFTO1lBQ2YsYUFBYSxFQUFFLE9BQU87WUFDdEIsYUFBYSxFQUFFO2dCQUNiLE9BQU8sRUFBRSx3REFBd0Q7Z0JBQ2pFLFVBQVUsRUFBRSxDQUFDO3dCQUNYLFNBQVMsRUFBRSxlQUFlO3dCQUMxQixNQUFNLEVBQUU7NEJBQ04sY0FBYyxFQUFFLElBQUk7NEJBQ3BCLE1BQU0sRUFBRSxDQUFDO3lCQUNWO3FCQUNGLENBQUM7YUFDSDtZQUNELGNBQWMsRUFBRSxNQUFN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LHVCQUF1QixHQUFJO1FBQzlJLElBQUksY0FBYyxHQUFHLElBQUk7UUFDekIsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsSUFBSSxDQUFDLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLElBQUksSUFBSSxDQUFDLEtBQUssQ0FBQyxlQUFlLENBQUMsTUFBTSxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUM7WUFDbEcsY0FBYyxHQUFHLElBQUksQ0FBQyx1QkFBdUIsRUFBRTtRQUNqRCxDQUFDO2FBQU0sQ0FBQztZQUNOLGNBQWM7Z0JBQ1osK0NBQUMsMENBQUssSUFDSixLQUFLLEVBQUUsRUFBRSxNQUFNLEVBQUUsU0FBUyxFQUFFO29CQUM1QiwrQ0FBQyw2Q0FBUSxJQUNQLE9BQU8sRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLGFBQWEsRUFBRSxRQUFRLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTs0QkFDakQsSUFBSSxDQUFDLGdCQUFnQixDQUFDO2dDQUNwQixNQUFNLEVBQUU7b0NBQ04sS0FBSyxFQUFFLENBQUMsQ0FBQyxNQUFNLENBQUMsT0FBTztpQ0FDeEI7NkJBQ0YsQ0FBQzt3QkFDSixDQUFDLEdBQ0Q7dUNBQXdCO1FBQ2hDLENBQUM7UUFDRCxPQUFPLHdEQUFLLEtBQUssRUFBRSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsRUFBRSxTQUFTLEVBQUMsYUFBYTtZQUMzRCxjQUFjO1lBQ2YsNERBQU0sVUFBVSxDQUFPLENBQ25CO0lBQ1IsQ0FBQztDQUNGO0FBRU8sU0FBUywyQkFBMkIsQ0FBQyxHQUFHLElBQUkscUJBQXVCLEdBQUcsR0FBRyxFQUFDLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXhiLWN1c3RvbS13aWRnZXRzL3dpZGdldHMvY2x1c3RlcmluZy9zcmMvcnVudGltZS9hc3NldHMvY2x1c3Rlci5zdmciLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LWFyY2dpc1wiIiwid2VicGFjazovL2V4Yi1jbGllbnQvZXh0ZXJuYWwgc3lzdGVtIFwiamltdS1jb3JlXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC9leHRlcm5hbCBzeXN0ZW0gXCJqaW11LXVpXCIiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC93ZWJwYWNrL2Jvb3RzdHJhcCIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9leGItY2xpZW50L3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC93ZWJwYWNrL3J1bnRpbWUvbWFrZSBuYW1lc3BhY2Ugb2JqZWN0Iiwid2VicGFjazovL2V4Yi1jbGllbnQvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2ppbXUtY29yZS9saWIvc2V0LXB1YmxpYy1wYXRoLnRzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leGItY3VzdG9tLXdpZGdldHMvd2lkZ2V0cy9jbHVzdGVyaW5nL3NyYy9ydW50aW1lL3dpZGdldC50c3giXSwic291cmNlc0NvbnRlbnQiOlsibW9kdWxlLmV4cG9ydHMgPSBcImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUENFdExTQkhaVzVsY21GMFpXUWdZbmtnU1dOdlRXOXZiaTVwYnlBdExUNEtQSE4yWnlCMlpYSnphVzl1UFNJeExqRWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SWdkMmxrZEdnOUlqTXlJaUJvWldsbmFIUTlJak15SWlCMmFXVjNRbTk0UFNJd0lEQWdNeklnTXpJaVBnbzhkR2wwYkdVK1kyeDFjM1JsY2p3dmRHbDBiR1UrQ2p4d1lYUm9JR1E5SWsweE1DQTBhQzAwWXkweExqRWdNQzB5SURBdU9TMHlJREoyTkdNd0lERXVNU0F3TGprZ01pQXlJREpvTkdNeExqRWdNQ0F5TFRBdU9TQXlMVEoyTFRSak1DMHhMakV0TUM0NUxUSXRNaTB5ZWlJK1BDOXdZWFJvUGdvOGNHRjBhQ0JrUFNKTk1qSWdNVEpvTkdNeExqRWdNQ0F5TFRBdU9TQXlMVEoyTFRSak1DMHhMakV0TUM0NUxUSXRNaTB5YUMwMFl5MHhMakVnTUMweUlEQXVPUzB5SURKMk5HTXdJREV1TVNBd0xqa2dNaUF5SURKNlRUSXlJRFpvTkhZMGFDMDBkaTAwZWlJK1BDOXdZWFJvUGdvOGNHRjBhQ0JrUFNKTk1UQWdNakJvTFRSakxURXVNU0F3TFRJZ01DNDVMVElnTW5ZMFl6QWdNUzR4SURBdU9TQXlJRElnTW1nMFl6RXVNU0F3SURJdE1DNDVJREl0TW5ZdE5HTXdMVEV1TVMwd0xqa3RNaTB5TFRKNlRURXdJREkyYUMwMGRpMDBhRFIyTkhvaVBqd3ZjR0YwYUQ0S1BIQmhkR2dnWkQwaVRUSTJJREl3YUMwMFl5MHhMakVnTUMweUlEQXVPUzB5SURKMk5HTXdJREV1TVNBd0xqa2dNaUF5SURKb05HTXhMakVnTUNBeUxUQXVPU0F5TFRKMkxUUmpNQzB4TGpFdE1DNDVMVEl0TWkweWVpSStQQzl3WVhSb1BnbzhjR0YwYUNCa1BTSk5NamdnTVRab0xUSmpMVEl1TmpjeElEQXROUzR4T0RJdE1TNHdOREF0Tnk0d056RXRNaTQ1TWpsekxUSXVPVEk1TFRRdU5DMHlMamt5T1MwM0xqQTNNWFl0TW1Nd0xUSXVNaTB4TGpndE5DMDBMVFJvTFRoakxUSXVNaUF3TFRRZ01TNDRMVFFnTkhZNFl6QWdNaTR5SURFdU9DQTBJRFFnTkdneVl6SXVOamN4SURBZ05TNHhPRElnTVM0d05EQWdOeTR3TnpFZ01pNDVNamx6TWk0NU1qa2dOQzQwSURJdU9USTVJRGN1TURjeGRqSmpNQ0F5TGpJZ01TNDRJRFFnTkNBMGFEaGpNaTR5SURBZ05DMHhMamdnTkMwMGRpMDRZekF0TWk0eUxURXVPQzAwTFRRdE5IcE5NekFnTWpoak1DQXdMalV6TFRBdU1qQTVJREV1TURNeExUQXVOVGc1SURFdU5ERXhjeTB3TGpnNE1TQXdMalU0T1MweExqUXhNU0F3TGpVNE9XZ3RPR010TUM0MU15QXdMVEV1TURNeExUQXVNakE1TFRFdU5ERXhMVEF1TlRnNWN5MHdMalU0T1Mwd0xqZzRNUzB3TGpVNE9TMHhMalF4TVhZdE1tTXdMVFl1TmpJM0xUVXVNemN6TFRFeUxURXlMVEV5YUMweVl5MHdMalV6SURBdE1TNHdNekV0TUM0eU1Ea3RNUzQwTVRFdE1DNDFPRGx6TFRBdU5UZzVMVEF1T0RneExUQXVOVGc1TFRFdU5ERXhkaTA0WXpBdE1DNDFNeUF3TGpJd09TMHhMakF6TVNBd0xqVTRPUzB4TGpReE1YTXdMamc0TVMwd0xqVTRPU0F4TGpReE1TMHdMalU0T1dnNFl6QXVOVE1nTUNBeExqQXpNU0F3TGpJd09TQXhMalF4TVNBd0xqVTRPWE13TGpVNE9TQXdMamc0TVNBd0xqVTRPU0F4TGpReE1YWXlZekFnTmk0Mk1qY2dOUzR6TnpNZ01USWdNVElnTVRKb01tTXdMalV6SURBZ01TNHdNekVnTUM0eU1Ea2dNUzQwTVRFZ01DNDFPRGx6TUM0MU9Ea2dNQzQ0T0RFZ01DNDFPRGtnTVM0ME1URjJPSG9pUGp3dmNHRjBhRDRLUEM5emRtYytDZz09XCIiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfamltdV9hcmNnaXNfXzsiLCJtb2R1bGUuZXhwb3J0cyA9IF9fV0VCUEFDS19FWFRFUk5BTF9NT0RVTEVfamltdV9jb3JlX187IiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFX2ppbXVfdWlfXzsiLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuIiwiLy8gZGVmaW5lIGdldHRlciBmdW5jdGlvbnMgZm9yIGhhcm1vbnkgZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5kID0gKGV4cG9ydHMsIGRlZmluaXRpb24pID0+IHtcblx0Zm9yKHZhciBrZXkgaW4gZGVmaW5pdGlvbikge1xuXHRcdGlmKF9fd2VicGFja19yZXF1aXJlX18ubyhkZWZpbml0aW9uLCBrZXkpICYmICFfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZXhwb3J0cywga2V5KSkge1xuXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIGtleSwgeyBlbnVtZXJhYmxlOiB0cnVlLCBnZXQ6IGRlZmluaXRpb25ba2V5XSB9KTtcblx0XHR9XG5cdH1cbn07IiwiX193ZWJwYWNrX3JlcXVpcmVfXy5vID0gKG9iaiwgcHJvcCkgPT4gKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApKSIsIi8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uciA9IChleHBvcnRzKSA9PiB7XG5cdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuXHR9XG5cdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiLyoqXHJcbiAqIFdlYnBhY2sgd2lsbCByZXBsYWNlIF9fd2VicGFja19wdWJsaWNfcGF0aF9fIHdpdGggX193ZWJwYWNrX3JlcXVpcmVfXy5wIHRvIHNldCB0aGUgcHVibGljIHBhdGggZHluYW1pY2FsbHkuXHJcbiAqIFRoZSByZWFzb24gd2h5IHdlIGNhbid0IHNldCB0aGUgcHVibGljUGF0aCBpbiB3ZWJwYWNrIGNvbmZpZyBpczogd2UgY2hhbmdlIHRoZSBwdWJsaWNQYXRoIHdoZW4gZG93bmxvYWQuXHJcbiAqICovXHJcbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxyXG4vLyBAdHMtaWdub3JlXHJcbl9fd2VicGFja19wdWJsaWNfcGF0aF9fID0gd2luZG93LmppbXVDb25maWcuYmFzZVVybFxyXG4iLCIvKiogQGpzeCBqc3ggKi9cbi8qKlxuICBMaWNlbnNpbmdcblxuICBDb3B5cmlnaHQgMjAyMiBFc3JpXG5cbiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTsgWW91XG4gIG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLiBZb3UgbWF5XG4gIG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cbiAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvclxuICBpbXBsaWVkLiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmdcbiAgcGVybWlzc2lvbnMgYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuXG4gIEEgY29weSBvZiB0aGUgbGljZW5zZSBpcyBhdmFpbGFibGUgaW4gdGhlIHJlcG9zaXRvcnknc1xuICBMSUNFTlNFIGZpbGUuXG4qL1xuaW1wb3J0IHsgUmVhY3QsIHR5cGUgQWxsV2lkZ2V0UHJvcHMsIGpzeCB9IGZyb20gJ2ppbXUtY29yZSdcbmltcG9ydCB7IEppbXVNYXBWaWV3Q29tcG9uZW50LCB0eXBlIEppbXVNYXBWaWV3IH0gZnJvbSAnamltdS1hcmNnaXMnXG5pbXBvcnQgeyBMYWJlbCwgQ2hlY2tib3gsIFdpZGdldFBsYWNlaG9sZGVyIH0gZnJvbSAnamltdS11aSdcblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgamltdU1hcFZpZXc6IEppbXVNYXBWaWV3XG4gIGNsdXN0ZXJMYXllcjogc3RyaW5nXG4gIGNsdXN0ZXJTdGF0dXM6IGJvb2xlYW5cbiAgZXJyb3JUaXA6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV2lkZ2V0IGV4dGVuZHMgUmVhY3QuUHVyZUNvbXBvbmVudDxBbGxXaWRnZXRQcm9wczxhbnk+LCBTdGF0ZT4ge1xuICBjb25zdHJ1Y3RvciAocHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcylcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBqaW11TWFwVmlldzogdW5kZWZpbmVkLFxuICAgICAgY2x1c3RlckxheWVyOiB1bmRlZmluZWQsXG4gICAgICBjbHVzdGVyU3RhdHVzOiBmYWxzZSxcbiAgICAgIGVycm9yVGlwOiB0cnVlXG4gICAgfVxuICB9XG5cbiAgY2x1c3RlckNvbmZpZyA9IHtcbiAgICB0eXBlOiAnY2x1c3RlcicsXG4gICAgY2x1c3RlclJhZGl1czogJzEwMHB4JyxcbiAgICBwb3B1cFRlbXBsYXRlOiB7XG4gICAgICBjb250ZW50OiAnVGhpcyBjbHVzdGVyIHJlcHJlc2VudHMgPGI+e2NsdXN0ZXJfY291bnR9PC9iPiBwb2ludHMuJyxcbiAgICAgIGZpZWxkSW5mb3M6IFt7XG4gICAgICAgIGZpZWxkTmFtZTogJ2NsdXN0ZXJfY291bnQnLFxuICAgICAgICBmb3JtYXQ6IHtcbiAgICAgICAgICBkaWdpdFNlcGFyYXRvcjogdHJ1ZSxcbiAgICAgICAgICBwbGFjZXM6IDBcbiAgICAgICAgfVxuICAgICAgfV1cbiAgICB9LFxuICAgIGNsdXN0ZXJNaW5TaXplOiAnMjRweCcsXG4gICAgY2x1c3Rlck1heFNpemU6ICc2MHB4JyxcbiAgICBsYWJlbGluZ0luZm86IFt7XG4gICAgICBkZWNvbmZsaWN0aW9uU3RyYXRlZ3k6ICdub25lJyxcbiAgICAgIGxhYmVsRXhwcmVzc2lvbkluZm86IHtcbiAgICAgICAgZXhwcmVzc2lvbjogXCJUZXh0KCRmZWF0dXJlLmNsdXN0ZXJfY291bnQsICcjLCMjIycpXCJcbiAgICAgIH0sXG5cbiAgICAgIGxhYmVsUGxhY2VtZW50OiAnY2VudGVyLWNlbnRlcidcbiAgICB9XVxuXG4gIH1cblxuICBvbkNoZWNrQm94Q2hhbmdlID0gKGUpID0+IHtcbiAgICBjb25zdCB2YWx1ZVN0YXRlID0gZS50YXJnZXQudmFsdWVcbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGNsdXN0ZXJTdGF0dXM6IHZhbHVlU3RhdGVcbiAgICB9LCAoKSA9PiB7XG4gICAgICB0aGlzLmNsdXN0ZXJTd2l0Y2godGhpcy5zdGF0ZS5jbHVzdGVyU3RhdHVzKVxuICAgIH0pXG4gIH1cblxuICBjbHVzdGVyU3dpdGNoID0gKGUpID0+IHtcbiAgICBpZiAodGhpcy5zdGF0ZS5jbHVzdGVyU3RhdHVzKSB7XG4gICAgICB0aGlzLnN0YXRlLmppbXVNYXBWaWV3LmppbXVMYXllclZpZXdzW3RoaXMuc3RhdGUuY2x1c3RlckxheWVyXS5sYXllci5mZWF0dXJlUmVkdWN0aW9uID0gdGhpcy5jbHVzdGVyQ29uZmlnXG4gICAgfVxuICAgIGlmICghdGhpcy5zdGF0ZS5jbHVzdGVyU3RhdHVzKSB7IHRoaXMuc3RhdGUuamltdU1hcFZpZXcuamltdUxheWVyVmlld3NbdGhpcy5zdGF0ZS5jbHVzdGVyTGF5ZXJdLmxheWVyLmZlYXR1cmVSZWR1Y3Rpb24gPSB0aGlzLnN0YXRlLmNsdXN0ZXJTdGF0dXMgPyB0aGlzLmNsdXN0ZXJDb25maWcgOiBudWxsIH1cbiAgfVxuXG4gIGFjdGl2ZVZpZXdDaGFuZ2VIYW5kbGVyID0gKGptdjogSmltdU1hcFZpZXcpID0+IHtcbiAgICBpZiAoam12KSB7XG4gICAgICBjb25zdCBqaW11TGF5ZXJWaWV3cyA9IGptdi5qaW11TGF5ZXJWaWV3c1xuICAgICAgY29uc3QgamltdUxheWVyVmlld0lkcyA9IE9iamVjdC5rZXlzKGppbXVMYXllclZpZXdzKVswXVxuICAgICAgY29uc3QgbGF5ZXJWaWV3SWQgPSBqaW11TGF5ZXJWaWV3SWRzXG5cbiAgICAgIGlmIChsYXllclZpZXdJZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGptdiA9IG51bGxcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICBqaW11TWFwVmlldzogam12LFxuICAgICAgICBjbHVzdGVyTGF5ZXI6IGppbXVMYXllclZpZXdJZHMsXG4gICAgICAgIGVycm9yVGlwOiBmYWxzZVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGppbXVNYXBWaWV3OiB1bmRlZmluZWQsXG4gICAgICAgIGNsdXN0ZXJMYXllcjogdW5kZWZpbmVkLFxuICAgICAgICBlcnJvclRpcDogdHJ1ZSxcbiAgICAgICAgY2x1c3RlclN0YXR1czogZmFsc2VcbiAgICAgIH0pXG4gICAgfVxuICB9XG5cbiAgcmVuZGVyV2lkZ2V0UGxhY2Vob2xkZXIgKCkge1xuICAgIHJldHVybiA8V2lkZ2V0UGxhY2Vob2xkZXIgaWNvbj17cmVxdWlyZSgnLi9hc3NldHMvY2x1c3Rlci5zdmcnKX0gd2lkZ2V0SWQ9e3RoaXMucHJvcHMuaWR9IG1lc3NhZ2U9eydQbGVhc2Ugc2VsZWN0IGEgd2ViIG1hcCB3aXRoIGEgZmVhdHVyZSBsYXllciB0byBlbmFibGUgcG9pbnQgY2x1c3RlcmluZy4nfSAvPlxuICB9XG5cbiAgcmVuZGVyICgpIHtcbiAgICBjb25zdCBtYXBDb250ZW50ID0gPEppbXVNYXBWaWV3Q29tcG9uZW50IHVzZU1hcFdpZGdldElkPXt0aGlzLnByb3BzLnVzZU1hcFdpZGdldElkcz8uWzBdfSBvbkFjdGl2ZVZpZXdDaGFuZ2U9e3RoaXMuYWN0aXZlVmlld0NoYW5nZUhhbmRsZXJ9IC8+XG4gICAgbGV0IGNsdXN0ZXJDb250ZW50ID0gbnVsbFxuICAgIGlmICh0aGlzLnN0YXRlLmVycm9yVGlwIHx8ICEodGhpcy5wcm9wcy51c2VNYXBXaWRnZXRJZHMgJiYgdGhpcy5wcm9wcy51c2VNYXBXaWRnZXRJZHMubGVuZ3RoID4gMCkpIHtcbiAgICAgIGNsdXN0ZXJDb250ZW50ID0gdGhpcy5yZW5kZXJXaWRnZXRQbGFjZWhvbGRlcigpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNsdXN0ZXJDb250ZW50ID1cbiAgICAgICAgPExhYmVsXG4gICAgICAgICAgc3R5bGU9e3sgY3Vyc29yOiAncG9pbnRlcicgfX0gPlxuICAgICAgICAgIDxDaGVja2JveFxuICAgICAgICAgICAgY2hlY2tlZD17dGhpcy5zdGF0ZS5jbHVzdGVyU3RhdHVzfSBvbkNoYW5nZT17KGUpID0+IHtcbiAgICAgICAgICAgICAgdGhpcy5vbkNoZWNrQm94Q2hhbmdlKHtcbiAgICAgICAgICAgICAgICB0YXJnZXQ6IHtcbiAgICAgICAgICAgICAgICAgIHZhbHVlOiBlLnRhcmdldC5jaGVja2VkXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfX1cbiAgICAgICAgICAvPiBDbHVzdGVyIHBvaW50cyA8L0xhYmVsPlxuICAgIH1cbiAgICByZXR1cm4gPGRpdiBzdHlsZT17eyBoZWlnaHQ6ICcxMDAlJyB9fSBjbGFzc05hbWU9XCJjbHVzdGVyLW1hcFwiPlxuICAgICAge2NsdXN0ZXJDb250ZW50fVxuICAgICAgPGRpdj57bWFwQ29udGVudH08L2Rpdj5cbiAgICA8L2Rpdj5cbiAgfVxufVxuXG4gZXhwb3J0IGZ1bmN0aW9uIF9fc2V0X3dlYnBhY2tfcHVibGljX3BhdGhfXyh1cmwpIHsgX193ZWJwYWNrX3B1YmxpY19wYXRoX18gPSB1cmwgfSJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==